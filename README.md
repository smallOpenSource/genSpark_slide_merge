# ğŸ¯ GenSpark AI Slide Converter (GenSpark HTML Slide Converter)

![Version](https://img.shields.io/badge/version-v4.7-blue.svg)
![Python](https://img.shields.io/badge/python-3.6%2B-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)
![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Mac%20%7C%20Linux-lightgrey.svg)

A high-performance Python tool that converts multi-slide HTML generated by [**GenSpark AI**](https://www.genspark.ai/) into **completely offline** presentations.

## ğŸŒŸ What is GenSpark AI?

[**GenSpark AI**](https://www.genspark.ai/) is an AI-powered automatic slide generation service that creates professional presentation slides based on user-provided topics or text. This tool converts HTML slides generated by GenSpark into complete offline presentations.

## âœ¨ Key Features

### ğŸ¨ UI/UX Enhancements
- ğŸ“¦ **Centered Slide Container**: Screen-centered layout + complete preservation of original content styles
- ğŸ­ **Complete CSS Isolation per Slide**: CSS scoping prevents style conflicts entirely
- ğŸ“œ **Infinite Scroll Support**: Free vertical scrolling for long content
- ğŸŒ“ **Auto Dark Theme**: GitHub Dark theme code highlighting
- ğŸ” **Fullscreen Mode**: Immersive presentation with F11 or button

### ğŸ“Š Technical Features
- ğŸš€ **Perfect Chart.js Compatibility**: Multi-chart conflict resolution and independent rendering
- ğŸ”¤ **Complete Font Awesome Embedding**: All icons work offline
- ğŸŒ **CDN Resource Localization**: Download & embed all external resources
- ğŸ’¾ **Intelligent Caching**: Prevent duplicate downloads for faster conversion
- ğŸ“± **Responsive Design**: Optimized viewing on all devices

### ğŸ¯ Conversion Process
- ğŸ“„ **DOCTYPE-based Splitting**: Auto-detect and split GenSpark multi-slides
- ğŸ”— **Slide Merging**: Perfect combination into unified presentation
- âš¡ **Parallel Processing**: Multi-threaded resource downloading
- ğŸ›¡ï¸ **Error Recovery**: Auto-retry on network failures

## ğŸš€ Quick Start

### ğŸ“‹ Requirements
- **Python 3.6+** (3.8+ recommended)
- **Internet Connection** (for initial CDN resource download)
- **Web Browser** (Chrome, Firefox, Safari, Edge, etc.)

### ğŸ“¦ Installation

1. **Clone Repository**
```bash
git clone https://github.com/your-repo/genspark-converter.git
cd genspark-converter
```

2. **Install Dependencies**
```bash
pip install -r requirements.txt
```

Or manual installation:
```bash
pip install beautifulsoup4>=4.12.0 requests>=2.31.0 lxml>=4.9.0
```

## ğŸ’» Usage

### 1ï¸âƒ£ Basic Usage
1. Save HTML slide files generated by [GenSpark AI](https://www.genspark.ai/) in the `source/` folder
2. Run conversion command:

```bash
# Basic conversion
python converter.py merge13.html

# Extension optional
python converter.py merge13

# Windows batch file (for testing)
test.bat
```

3. Check converted file: `output/merge13_ppt.html`
4. Run presentation in web browser

### 2ï¸âƒ£ Directory Structure
```
ğŸ“ gen_merge/
â”œâ”€â”€ ğŸ“„ converter.py          # Main conversion script (v4.7)
â”œâ”€â”€ ğŸ“„ plan.py              # Modularization plan
â”œâ”€â”€ ğŸ“„ requirements.txt     # Dependencies list
â”œâ”€â”€ ğŸ“„ test.bat             # Windows test batch
â”œâ”€â”€ ğŸ“ source/              # Input: GenSpark HTML files
â”œâ”€â”€ ğŸ“ output/              # Output: Converted presentations
â”œâ”€â”€ ğŸ“ cache/               # Cache: Downloaded resources
â”œâ”€â”€ ğŸ“ build/               # Build: Distribution executables
â””â”€â”€ ğŸ“ assets/              # Assets: Default themes & icons
```

### 3ï¸âƒ£ File Conversion Flow
```
Input: source/merge13.html (GenSpark multi-slides)
  â†“ DOCTYPE pattern splitting
  â†“ Per-slide CSS isolation  
  â†“ CDN resource download & embedding
  â†“ Chart.js conflict resolution
  â†“ Navigation system construction
Output: output/merge13_ppt.html (Offline presentation)
```

## âŒ¨ï¸ Control Guide

### ğŸ¹ Keyboard Shortcuts
| Key Combination | Function | Description |
|-----------------|----------|-------------|
| `â†` `â†’` | Slide Navigation | Move to previous/next slide |
| `â†‘` `â†“` | In-slide Scroll | Scroll up/down within current slide |
| `Page Up/Down` | Page Scroll | Scroll one screen at a time |
| `Home` `End` | Scroll to Edge | Move to top/bottom of slide |
| `Ctrl+Home/End` | Slide Edge | Move to first/last slide |
| `F11` | Fullscreen Toggle | Turn fullscreen mode on/off |
| `Space` | Page Down | Scroll down with spacebar |

### ğŸ–±ï¸ Navigation Buttons (Bottom Right)
| Button | Icon | Function |
|--------|------|----------|
| **Home** | ğŸ  | Move to first slide |
| **Previous** | â—€ï¸ | Move to previous slide |
| **Counter** | `1/5` | Display current slide number |
| **Next** | â–¶ï¸ | Move to next slide |
| **End** | â­ï¸ | Move to last slide |
| **Fullscreen** | ğŸ”² | Toggle fullscreen mode |

### ğŸ“± Responsive Support
- **Desktop**: Full resolution (max 1280px width)
- **Tablet**: Auto-scaling and touch gestures
- **Mobile**: Support for both portrait/landscape modes

## ğŸ‰ v4.7 Major Updates

### âœ… New Features
- **ğŸ¯ Centered Slide Container**: Screen-centered layout + complete original style preservation
- **ğŸ”ª Smart DOCTYPE Splitting**: Auto-detect and accurate splitting of GenSpark multi-slides
- **ğŸ›¡ï¸ Complete CSS Isolation**: Independent CSS scoping per slide to block style conflicts
- **ğŸŒ™ GitHub Dark Theme**: Auto-detect code-snippet classes and force dark theme
- **ğŸ“œ Unlimited Scrolling**: Free vertical scrolling support for long content
- **ğŸ® Enhanced Navigation**: 6 buttons (home/prev/counter/next/end/fullscreen)
- **ğŸ“Š Complete Chart.js Compatibility**: Independent rendering per canvas, completely resolving multi-chart conflicts

### ğŸ› Major Bug Fixes
- âœ… Fixed missing `targetPriceDistChart` variable name issue
- âœ… Fixed Font Awesome font embedding path errors
- âœ… Completely blocked Chart.js multi-chart interference
- âœ… Safe handling of Canvas `getContext` access errors
- âœ… Isolated `const` variable conflicts with IIFE scope
- âœ… 100% preservation of GenSpark original styles
- âœ… Prevented chart memory leaks during slide transitions

### ğŸš€ Performance Improvements
- **âš¡ Parallel Downloads**: Multi-threaded CDN resource processing
- **ğŸ’¾ Intelligent Caching**: Complete elimination of duplicate downloads
- **ğŸ”„ Progressive Loading**: Delayed chart initialization per slide
- **ğŸ“¦ File Size Optimization**: CSS duplication removal (300MB+ â†’ normal size)

## ğŸ—ï¸ Project Architecture

### ğŸ“ Directory Structure
```
gen_merge/                          # ğŸ  Project root
â”œâ”€â”€ ğŸ“„ converter.py                 # ğŸ¯ Main conversion script (1953 lines)
â”œâ”€â”€ ğŸ“„ plan.py                      # ğŸ“‹ Modularization plan (future refactoring)
â”œâ”€â”€ ğŸ“„ requirements.txt             # ğŸ“¦ Python dependencies specification
â”œâ”€â”€ ğŸ“„ test.bat                     # ğŸ§ª Windows test batch file
â”œâ”€â”€ ğŸ“„ README.md                    # ğŸ“– Project documentation (Korean)
â”œâ”€â”€ ğŸ“„ README-en.md                 # ğŸ“– Project documentation (English)
â”œâ”€â”€ ğŸ“ source/                      # ğŸ“¥ GenSpark HTML input folder
â”‚   â””â”€â”€ merge*.html                 # GenSpark AI generated slides
â”œâ”€â”€ ğŸ“ output/                      # ğŸ“¤ Converted presentation output
â”‚   â””â”€â”€ *_ppt.html                  # Completed offline PPT
â”œâ”€â”€ ğŸ“ cache/                       # ğŸ’¾ CDN resource cache
â”‚   â”œâ”€â”€ cache_index.json            # Cache metadata
â”‚   â””â”€â”€ *.woff2, *.css, *.js        # Downloaded resources
â”œâ”€â”€ ğŸ“ build/                       # ğŸ”¨ Build and distribution files
â””â”€â”€ ğŸ“ assets/                      # ğŸ¨ Default themes and icons
    â”œâ”€â”€ default_theme.css
    â””â”€â”€ icons/
```

### ğŸ§© Core Class Structure
```python
# Current monolithic structure (converter.py)
GoogleFontsProcessor     # Google Fonts CSS/font processing
ResourceCache           # CDN resource caching system  
GenSparkConverter       # Main conversion logic (1500+ lines)
â”œâ”€â”€ HTML parsing & splitting
â”œâ”€â”€ CSS scoping & isolation
â”œâ”€â”€ Code snippet formatting
â”œâ”€â”€ Chart.js conflict resolution
â”œâ”€â”€ Slide manager generation
â””â”€â”€ Resource embedding

# Future modular structure (see plan.py)
converter/
â”œâ”€â”€ core/               # Conversion orchestrator
â”œâ”€â”€ resources/          # Resource download & caching
â”œâ”€â”€ parsers/            # HTML/CSS/code parsing
â”œâ”€â”€ generators/         # Script/navigation generation
â””â”€â”€ utils/              # Common utilities
```

### ğŸ”„ Conversion Workflow
```mermaid
graph TD
    A[GenSpark HTML] --> B[DOCTYPE Splitting]
    B --> C[Per-slide Processing]
    C --> D[CSS Scoping]
    C --> E[CDN Download]
    C --> F[Chart.js Modification]
    D --> G[Slide Merging]
    E --> G
    F --> G
    G --> H[Navigation Addition]
    H --> I[Offline PPT]
```

## ğŸ”§ Advanced Settings & Troubleshooting

### âš™ï¸ Configuration Options
```python
# Key settings in converter.py
CDN_PATTERNS = [...]           # Supported CDN patterns
CACHE_TTL = 86400             # Cache validity period (24 hours)
MAX_WIDTH = "1280px"          # Maximum slide width
CHART_DELAY = 500             # Chart initialization delay (ms)
```

### ğŸ› Common Issue Resolution

#### 1. Conversion Failure
```bash
# Issue: HTML file not found
[ERROR] Input file not found: source/merge13.html

# Solution: Check file path
- Verify file exists in source/ folder
- Check filename and extension accuracy
```

#### 2. Network Errors
```bash
# Issue: CDN resource download failure
[ERROR] Download failed: https://cdn.jsdelivr.net/...

# Solutions:
- Check internet connection status
- Verify firewall/proxy settings
- Delete partial cache files in cache/ folder and retry
```

#### 3. Chart Display Errors
```bash
# Issue: Charts not displaying
[WARN] No canvas found in: slide-0

# Solutions:
- Check JavaScript errors in browser developer tools
- Verify Chart.js CDN loading status
- Wait for chart re-initialization after slide transition
```

### ğŸ” Debug Mode
```bash
# Check detailed logs
python converter.py merge13.html 2>&1 | findstr "ERROR"

# Check cache status
dir cache\cache_index.json

# Verify conversion results
start output\merge13_ppt.html
```

### ğŸ“Š Performance Optimization Tips
1. **Cache Utilization**: Same CDN resources are reused
2. **Internet Speed**: High-speed internet recommended for first conversion
3. **Memory Management**: Increase Python memory allocation for large file conversion
4. **Parallel Processing**: Accelerate resource downloads with multi-threading

## ğŸ¤ Contributing & Development

### ğŸ› ï¸ Development Environment Setup
```bash
# Install development dependencies
pip install -r requirements.txt

# Run tests
test.bat

# Code quality check (optional)
pip install flake8 black
flake8 converter.py
black converter.py
```

### ğŸ“ˆ Future Development Plans
- ğŸ“‹ [**Modularization Plan**](plan.py): Current 1953-line monolith â†’ modular architecture
- ğŸ§ª **Test Coverage**: Add unit tests and CI/CD setup
- ğŸ¨ **Theme System**: Support for custom themes
- ğŸ”Œ **Plugin Architecture**: Extensible module system
- ğŸ“± **Mobile Optimization**: PWA support and enhanced touch gestures

### ğŸ Bug Reports
When reporting issues, please include:
- Python version and OS information
- Input file size and slide count
- Complete error message
- Minimal reproducible example

## ğŸ“„ License

**MIT License** - Free to use, modify, and distribute

```
Copyright (c) 2024 GenSpark Converter Team

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

---

## ğŸŒŸ Star History

â­ **If this project helped you, please give it a star!**

**ğŸš€ Transform GenSpark AI's powerful slides into perfect offline presentations!**
