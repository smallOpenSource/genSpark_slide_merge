# üéØ GenSpark AI Slide Converter (GenSpark HTML Slide Converter)

![Version](https://img.shields.io/badge/version-v4.7-blue.svg)
![Python](https://img.shields.io/badge/python-3.6%2B-green.svg)
![License](https://img.shields.io/badge/license-MIT-orange.svg)
![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20Mac%20%7C%20Linux-lightgrey.svg)

A high-performance Python tool that converts multi-slide HTML generated by [**GenSpark AI**](https://www.genspark.ai/) into **completely offline** presentations.

## üåü What is GenSpark AI?

[**GenSpark AI**](https://www.genspark.ai/) is an AI-powered automatic slide generation service that creates professional presentation slides based on user-provided topics or text. This tool converts HTML slides generated by GenSpark into complete offline presentations.

## ‚ú® Key Features

### üé® UI/UX Enhancements
- üì¶ **Centered Slide Container**: Screen-centered layout + complete preservation of original content styles
- üé≠ **Complete CSS Isolation per Slide**: CSS scoping prevents style conflicts entirely
- üìú **Infinite Scroll Support**: Free vertical scrolling for long content
- üåì **Auto Dark Theme**: GitHub Dark theme code highlighting
- üîç **Fullscreen Mode**: Immersive presentation with F11 or button

### üìä Technical Features
- üöÄ **Perfect Chart.js Compatibility**: Multi-chart conflict resolution and independent rendering
- üî§ **Complete Font Awesome Embedding**: All icons work offline
- üåê **CDN Resource Localization**: Download & embed all external resources
- üíæ **Intelligent Caching**: Prevent duplicate downloads for faster conversion
- üì± **Responsive Design**: Optimized viewing on all devices

### üéØ Conversion Process
- üìÑ **DOCTYPE-based Splitting**: Auto-detect and split GenSpark multi-slides
- üîó **Slide Merging**: Perfect combination into unified presentation
- ‚ö° **Parallel Processing**: Multi-threaded resource downloading
- üõ°Ô∏è **Error Recovery**: Auto-retry on network failures

## üöÄ Quick Start

### üìã Requirements
- **Python 3.6+** (3.8+ recommended)
- **Internet Connection** (for initial CDN resource download)
- **Web Browser** (Chrome, Firefox, Safari, Edge, etc.)

### üì¶ Installation

1. **Clone Repository**
```bash
git clone https://github.com/your-repo/genspark-converter.git
cd genspark-converter
```

2. **Install Dependencies**
```bash
pip install -r requirements.txt
```

Or manual installation:
```bash
pip install beautifulsoup4>=4.12.0 requests>=2.31.0 lxml>=4.9.0
```

## üíª Usage

### 1Ô∏è‚É£ Basic Usage
1. Save HTML slide files generated by [GenSpark AI](https://www.genspark.ai/) in the `source/` folder
2. Run conversion command:

```bash
# Basic conversion
python converter.py merge13.html

# Extension optional
python converter.py merge13

# Windows batch file (for testing)
test.bat
```

3. Check converted file: `output/merge13_ppt.html`
4. Run presentation in web browser

### 2Ô∏è‚É£ Directory Structure
```
üìÅ gen_merge/
‚îú‚îÄ‚îÄ üìÑ converter.py          # Main conversion script (v4.7)
‚îú‚îÄ‚îÄ üìÑ plan.py              # Modularization plan
‚îú‚îÄ‚îÄ üìÑ requirements.txt     # Dependencies list
‚îú‚îÄ‚îÄ üìÑ test.bat             # Windows test batch
‚îú‚îÄ‚îÄ üìÅ source/              # Input: GenSpark HTML files
‚îú‚îÄ‚îÄ üìÅ output/              # Output: Converted presentations
‚îú‚îÄ‚îÄ üìÅ cache/               # Cache: Downloaded resources
‚îú‚îÄ‚îÄ üìÅ build/               # Build: Distribution executables
‚îî‚îÄ‚îÄ üìÅ assets/              # Assets: Default themes & icons
```

### 3Ô∏è‚É£ File Conversion Flow
```
Input: source/merge13.html (GenSpark multi-slides)
  ‚Üì DOCTYPE pattern splitting
  ‚Üì Per-slide CSS isolation  
  ‚Üì CDN resource download & embedding
  ‚Üì Chart.js conflict resolution
  ‚Üì Navigation system construction
Output: output/merge13_ppt.html (Offline presentation)
```

## ‚å®Ô∏è Control Guide

### üéπ Keyboard Shortcuts
| Key Combination | Function | Description |
|-----------------|----------|-------------|
| `‚Üê` `‚Üí` | Slide Navigation | Move to previous/next slide |
| `‚Üë` `‚Üì` | In-slide Scroll | Scroll up/down within current slide |
| `Page Up/Down` | Page Scroll | Scroll one screen at a time |
| `Home` `End` | Scroll to Edge | Move to top/bottom of slide |
| `Ctrl+Home/End` | Slide Edge | Move to first/last slide |
| `F11` | Fullscreen Toggle | Turn fullscreen mode on/off |
| `Space` | Page Down | Scroll down with spacebar |

### üñ±Ô∏è Navigation Buttons (Bottom Right)
| Button | Icon | Function |
|--------|------|----------|
| **Home** | üè† | Move to first slide |
| **Previous** | ‚óÄÔ∏è | Move to previous slide |
| **Counter** | `1/5` | Display current slide number |
| **Next** | ‚ñ∂Ô∏è | Move to next slide |
| **End** | ‚è≠Ô∏è | Move to last slide |
| **Fullscreen** | üî≤ | Toggle fullscreen mode |

### üì± Responsive Support
- **Desktop**: Full resolution (max 1280px width)
- **Tablet**: Auto-scaling and touch gestures
- **Mobile**: Support for both portrait/landscape modes

## üéâ v4.7 Major Updates

### ‚úÖ New Features
- **üéØ Centered Slide Container**: Screen-centered layout + complete original style preservation
- **üî™ Smart DOCTYPE Splitting**: Auto-detect and accurate splitting of GenSpark multi-slides
- **üõ°Ô∏è Complete CSS Isolation**: Independent CSS scoping per slide to block style conflicts
- **üåô GitHub Dark Theme**: Auto-detect code-snippet classes and force dark theme
- **üìú Unlimited Scrolling**: Free vertical scrolling support for long content
- **üéÆ Enhanced Navigation**: 6 buttons (home/prev/counter/next/end/fullscreen)
- **üìä Complete Chart.js Compatibility**: Independent rendering per canvas, completely resolving multi-chart conflicts

### üêõ Major Bug Fixes
- ‚úÖ Fixed missing `targetPriceDistChart` variable name issue
- ‚úÖ Fixed Font Awesome font embedding path errors
- ‚úÖ Completely blocked Chart.js multi-chart interference
- ‚úÖ Safe handling of Canvas `getContext` access errors
- ‚úÖ Isolated `const` variable conflicts with IIFE scope
- ‚úÖ 100% preservation of GenSpark original styles
- ‚úÖ Prevented chart memory leaks during slide transitions

### üöÄ Performance Improvements
- **‚ö° Parallel Downloads**: Multi-threaded CDN resource processing
- **üíæ Intelligent Caching**: Complete elimination of duplicate downloads
- **üîÑ Progressive Loading**: Delayed chart initialization per slide
- **üì¶ File Size Optimization**: CSS duplication removal (300MB+ ‚Üí normal size)

## üèóÔ∏è Project Architecture

### üìÅ Directory Structure
```
gen_merge/                          # üè† Project root
‚îú‚îÄ‚îÄ üìÑ converter.py                 # üéØ Main conversion script (1953 lines)
‚îú‚îÄ‚îÄ üìÑ plan.py                      # üìã Modularization plan (future refactoring)
‚îú‚îÄ‚îÄ üìÑ requirements.txt             # üì¶ Python dependencies specification
‚îú‚îÄ‚îÄ üìÑ test.bat                     # üß™ Windows test batch file
‚îú‚îÄ‚îÄ üìÑ README.md                    # üìñ Project documentation (Korean)
‚îú‚îÄ‚îÄ üìÑ README-en.md                 # üìñ Project documentation (English)
‚îú‚îÄ‚îÄ üìÅ source/                      # üì• GenSpark HTML input folder
‚îÇ   ‚îî‚îÄ‚îÄ merge*.html                 # GenSpark AI generated slides
‚îú‚îÄ‚îÄ üìÅ output/                      # üì§ Converted presentation output
‚îÇ   ‚îî‚îÄ‚îÄ *_ppt.html                  # Completed offline PPT
‚îú‚îÄ‚îÄ üìÅ cache/                       # üíæ CDN resource cache
‚îÇ   ‚îú‚îÄ‚îÄ cache_index.json            # Cache metadata
‚îÇ   ‚îî‚îÄ‚îÄ *.woff2, *.css, *.js        # Downloaded resources
‚îú‚îÄ‚îÄ üìÅ build/                       # üî® Build and distribution files
‚îî‚îÄ‚îÄ üìÅ assets/                      # üé® Default themes and icons
    ‚îú‚îÄ‚îÄ default_theme.css
    ‚îî‚îÄ‚îÄ icons/
```

### üß© Core Class Structure
```python
# Current monolithic structure (converter.py)
GoogleFontsProcessor     # Google Fonts CSS/font processing
ResourceCache           # CDN resource caching system  
GenSparkConverter       # Main conversion logic (1500+ lines)
‚îú‚îÄ‚îÄ HTML parsing & splitting
‚îú‚îÄ‚îÄ CSS scoping & isolation
‚îú‚îÄ‚îÄ Code snippet formatting
‚îú‚îÄ‚îÄ Chart.js conflict resolution
‚îú‚îÄ‚îÄ Slide manager generation
‚îî‚îÄ‚îÄ Resource embedding

# Future modular structure (see plan.py)
converter/
‚îú‚îÄ‚îÄ core/               # Conversion orchestrator
‚îú‚îÄ‚îÄ resources/          # Resource download & caching
‚îú‚îÄ‚îÄ parsers/            # HTML/CSS/code parsing
‚îú‚îÄ‚îÄ generators/         # Script/navigation generation
‚îî‚îÄ‚îÄ utils/              # Common utilities
```

### üîÑ Conversion Workflow
```mermaid
graph TD
    A[GenSpark HTML] --> B[DOCTYPE Splitting]
    B --> C[Per-slide Processing]
    C --> D[CSS Scoping]
    C --> E[CDN Download]
    C --> F[Chart.js Modification]
    D --> G[Slide Merging]
    E --> G
    F --> G
    G --> H[Navigation Addition]
    H --> I[Offline PPT]
```

## üîß Advanced Settings & Troubleshooting

### ‚öôÔ∏è Configuration Options
```python
# Key settings in converter.py
CDN_PATTERNS = [...]           # Supported CDN patterns
CACHE_TTL = 86400             # Cache validity period (24 hours)
MAX_WIDTH = "1280px"          # Maximum slide width
CHART_DELAY = 500             # Chart initialization delay (ms)
```

### üêõ Common Issue Resolution

#### 1. Conversion Failure
```bash
# Issue: HTML file not found
[ERROR] Input file not found: source/merge13.html

# Solution: Check file path
- Verify file exists in source/ folder
- Check filename and extension accuracy
```

#### 2. Network Errors
```bash
# Issue: CDN resource download failure
[ERROR] Download failed: https://cdn.jsdelivr.net/...

# Solutions:
- Check internet connection status
- Verify firewall/proxy settings
- Delete partial cache files in cache/ folder and retry
```

#### 3. Chart Display Errors
```bash
# Issue: Charts not displaying
[WARN] No canvas found in: slide-0

# Solutions:
- Check JavaScript errors in browser developer tools
- Verify Chart.js CDN loading status
- Wait for chart re-initialization after slide transition
```

### üîç Debug Mode
```bash
# Check detailed logs
python converter.py merge13.html 2>&1 | findstr "ERROR"

# Check cache status
dir cache\cache_index.json

# Verify conversion results
start output\merge13_ppt.html
```

### üìä Performance Optimization Tips
1. **Cache Utilization**: Same CDN resources are reused
2. **Internet Speed**: High-speed internet recommended for first conversion
3. **Memory Management**: Increase Python memory allocation for large file conversion
4. **Parallel Processing**: Accelerate resource downloads with multi-threading

## ü§ù Contributing & Development

### üõ†Ô∏è Development Environment Setup
```bash
# Install development dependencies
pip install -r requirements.txt

# Run tests
test.bat

# Code quality check (optional)
pip install flake8 black
flake8 converter.py
black converter.py
```

### üìà Future Development Plans
- üìã [**Modularization Plan**](plan.py): Current 1953-line monolith ‚Üí modular architecture
- üß™ **Test Coverage**: Add unit tests and CI/CD setup
- üé® **Theme System**: Support for custom themes
- üîå **Plugin Architecture**: Extensible module system
- üì± **Mobile Optimization**: PWA support and enhanced touch gestures

### üêû Bug Reports
When reporting issues, please include:
- Python version and OS information
- Input file size and slide count
- Complete error message
- Minimal reproducible example

## üìÑ License

**MIT License** - Free to use, modify, and distribute

```
Copyright (c) 2024 GenSpark Converter Team

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

---

## üåü Star History

‚≠ê **If this project helped you, please give it a star!**

**üöÄ Transform GenSpark AI's powerful slides into perfect offline presentations!**
